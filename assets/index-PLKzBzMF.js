(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();const He="modulepreload",Xe=function(e){return"/spaceship-dodge-game/"+e},Ae={},v=function(t,n,s){let o=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));o=Promise.allSettled(n.map(u=>{if(u=Xe(u),u in Ae)return;Ae[u]=!0;const a=u.endsWith(".css"),h=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${h}`))return;const f=document.createElement("link");if(f.rel=a?"stylesheet":He,a||(f.as="script"),f.crossOrigin="",f.href=u,c&&f.setAttribute("nonce",c),document.head.appendChild(f),a)return new Promise((g,A)=>{f.addEventListener("load",g),f.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${u}`)))})}))}function r(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return o.then(l=>{for(const c of l||[])c.status==="rejected"&&r(c.reason);return t().catch(r)})},d={value:"START"},T={value:0},P={value:0},I={value:3},De={value:0},E=[],p=[],re={value:0},B=[35,22,12],Ne=[20,50,100],Ce=.8,ke=2.5,Ke=.5,N="ontouchstart"in window||navigator.maxTouchPoints>0,Ve=N?2400:1500,Ge=70,U={value:!0},Ze=10,Ye=3,Je=100,m={doubleBlaster:{active:!1,timer:0},shield:{active:!1,timer:0}},i={x:380,y:500,width:30,height:45,speed:7,dx:0,dy:0},Qe=Object.freeze(Object.defineProperty({__proto__:null,ASTEROID_LEVEL_SIZES:B,ASTEROID_SCORE_VALUES:Ne,BASE_OBSTACLE_MAX_SPEED:ke,BASE_OBSTACLE_MIN_SPEED:Ce,BASE_SPAWN_INTERVAL:Ve,SPAWN_INTERVAL_DECREASE_PER_LEVEL:Ge,SPEED_INCREASE_PER_LEVEL:Ke,allowSpawning:U,bulletRadius:Ye,bulletSpeed:Ze,bullets:E,fireRate:Je,gameLevel:P,gameState:d,isMobile:N,lastObstacleSpawnTime:De,levelStartTime:re,obstacles:p,player:i,playerLives:I,powerUps:m,score:T},Symbol.toStringTag,{value:"Module"})),j=document.getElementById("startOverlay"),ee=document.getElementById("gameOverOverlay"),et=document.getElementById("finalScore"),te=document.getElementById("levelTransitionOverlay"),ne=document.getElementById("pauseOverlay"),tt=document.getElementById("levelUpMessage"),nt=document.getElementById("currentLevelInfo"),ot=document.getElementById("currentScoreInfo"),Se=document.getElementById("livesInfoStart"),Ie=document.getElementById("livesInfoLevel"),Te=document.getElementById("livesInfoPause");function _(e,t=0,n=0){switch([j,ne,ee,te].forEach(o=>{o.classList.add("hidden"),o.classList.remove("flex")}),Se&&(Se.textContent=`Lives: ${I.value}`),Ie&&(Ie.textContent=`Lives: ${I.value}`),Te&&(Te.textContent=`Lives: ${I.value}`),e){case"START":j.classList.remove("hidden"),j.classList.add("flex");break;case"GAME_OVER":v(()=>Promise.resolve().then(()=>w),void 0).then(o=>o.stopMusic()),et.textContent=`Final Score: ${t} (Level ${n+1})`,ee.classList.remove("hidden"),ee.classList.add("flex");break;case"LEVEL_TRANSITION":v(()=>Promise.resolve().then(()=>w),void 0).then(o=>o.stopMusic()),tt.textContent=`LEVEL ${n+1} !`,nt.textContent="Get Ready!",ot.textContent=`Score: ${t}`,te.classList.remove("hidden"),te.classList.add("flex");break;case"PAUSED":v(()=>Promise.resolve().then(()=>w),void 0).then(o=>o.stopMusic()),ne.classList.remove("hidden"),ne.classList.add("flex");break;case"PLAYING":j.style.display="none",v(()=>Promise.resolve().then(()=>w),void 0).then(o=>o.startMusic());break}document.dispatchEvent(new Event("gameStateChange"))}function ve(e){const t=window.innerWidth,n=window.innerHeight;t<600?(e.height=n*.95,e.width=t):(e.width=t*.9,e.height=n*.9)}function pe(){confirm("Are you sure you want to quit the game?")&&Promise.all([v(()=>Promise.resolve().then(()=>w),void 0),v(()=>Promise.resolve().then(()=>Qe),void 0),v(()=>Promise.resolve().then(()=>Ue),void 0)]).then(([t,n,s])=>{t.stopMusic(),n.gameState.value="GAME_OVER",n.bullets.length=0,n.obstacles.length=0,Object.keys(n.powerUps).forEach(o=>{n.powerUps[o].active=!1,n.powerUps[o].timer=0}),t.playSound("gameover"),s.showOverlay("GAME_OVER",n.score.value,n.gameLevel.value)})}function ge(e){const t=e.getBoundingClientRect();[j,ee,te,ne].forEach(n=>{n.style.width=t.width+"px",n.style.height=t.height+"px",n.style.left=t.left+"px",n.style.top=t.top+"px"})}const Ue=Object.freeze(Object.defineProperty({__proto__:null,initializeCanvas:ve,quitGame:pe,setOverlayDimensions:ge,showOverlay:_},Symbol.toStringTag,{value:"Module"}));function it(e){const t=e.getContext("2d"),n=[],s=100;function o(){e.width=window.innerWidth,e.height=window.innerHeight}o(),window.addEventListener("resize",o);for(let l=0;l<s;l++)n.push({x:Math.random()*e.width,y:Math.random()*e.height,radius:Math.random()*1.5+.5,speed:Math.random()*.5+.1});function r(){t.clearRect(0,0,e.width,e.height),t.fillStyle="white";for(const l of n)l.y+=l.speed,l.y>e.height&&(l.y=0,l.x=Math.random()*e.width),t.beginPath(),t.arc(l.x,l.y,l.radius,0,2*Math.PI),t.fill();requestAnimationFrame(r)}r()}const W="/spaceship-dodge-game/",y={bgm:new Audio(`${W}sounds/bg-music.mp3`),fire:new Audio(`${W}sounds/fire.mp3`),break:new Audio(`${W}sounds/break.mp3`),gameover:new Audio(`${W}sounds/gameover.mp3`),levelup:new Audio(`${W}sounds/levelup.mp3`)};let D=.4,L=!1,le=!1;y.bgm.loop=!0;we();function we(){Object.values(y).forEach(e=>{e.volume=L?0:D,e.muted=L})}function $e(e){D=e,L||Object.values(y).forEach(t=>{t.volume=D})}function K(){L=!0,we()}function $(){L=!1,we()}function Z(e){if(L||!y[e])return;le||Pe();const t=y[e].cloneNode();t.volume=L?0:D,t.muted=L,t.play().catch(n=>console.error(`Error playing sound ${e}:`,n))}function Fe(){L||(le||Pe(),setTimeout(()=>{y.bgm.volume=L?0:D,y.bgm.muted=L,y.bgm.play().catch(e=>console.error("Error playing bgm:",e))},100))}function ue(){y.bgm.pause(),y.bgm.currentTime=0}function Pe(){le||Promise.all(Object.values(y).map(e=>e.play().then(()=>{e.pause(),e.currentTime=0}).catch(()=>{}))).then(()=>{le=!0,console.log("Audio context unlocked")})}const w=Object.freeze(Object.defineProperty({__proto__:null,get currentVolume(){return D},muteAll:K,playSound:Z,setVolume:$e,startMusic:Fe,stopMusic:ue,unlockAudio:Pe,unmuteAll:$},Symbol.toStringTag,{value:"Module"}));function fe(e,t){d.value==="PLAYING"&&(E.push({x:e,y:t,radius:Ye,dy:-10}),Z("fire"))}function st(e){for(let t=E.length-1;t>=0;t--){const n=E[t];n.y+=n.dy,n.y+n.radius<0&&E.splice(t,1)}}function rt(e){e.fillStyle="#ffff88",E.forEach(t=>{e.beginPath(),e.arc(t.x,t.y,t.radius,0,Math.PI*2),e.fill()})}function lt(){if(d.value!=="PLAYING")return;i.x+=i.dx,i.y+=i.dy;const e=document.getElementById("gameCanvas");i.x=Math.max(0,Math.min(i.x,e.width-i.width)),i.y=Math.max(0,Math.min(i.y,e.height-i.height))}function at(e){if(d.value!=="PLAYING")return;if(m.shield.active){e.save(),e.shadowColor="#0ff",e.shadowBlur=20,e.strokeStyle="#00ffff",e.lineWidth=4;const je=i.x+i.width/2,ze=i.y+i.height/2,qe=Math.max(i.width,i.height)*.7;e.beginPath(),e.arc(je,ze,qe,0,Math.PI*2),e.stroke(),e.restore()}e.strokeStyle="#00ffff",e.lineWidth=2;const t=i.width,n=i.height,s=i.x,o=i.y,r=s+t/2,l=.3;e.beginPath(),e.moveTo(r,o),e.lineTo(s+t*.2,o+n*.8),e.lineTo(r-t*l,o+n*.75),e.lineTo(r+t*l,o+n*.75),e.lineTo(s+t*.8,o+n*.8),e.closePath(),e.stroke();const c=t*.2,u=t*.07,a=n*.3,h=o+n*.75,f=h+a,g=r-c/2,A=r+c/2,F=r-u/2,C=r+u/2;e.beginPath(),e.moveTo(g,h),e.lineTo(A,h),e.lineTo(C,f),e.lineTo(F,f),e.closePath(),e.stroke(),e.beginPath(),e.moveTo(r,h+a*.2),e.lineTo(r,h+a*.8),e.moveTo(r-u*.8,h+a*.3),e.lineTo(r-u*.8,h+a*.7),e.moveTo(r+u*.8,h+a*.3),e.lineTo(r+u*.8,h+a*.7),e.stroke();const x=performance.now()/500,k=(Math.sin(x)+1)/2,V=r,ce=f+5,O=u,de=e.createRadialGradient(V,ce,0,V,ce,O*3);de.addColorStop(0,`rgba(0, 255, 255, ${.6*k})`),de.addColorStop(1,"rgba(0, 255, 255, 0)"),e.fillStyle=de,e.beginPath(),e.ellipse(V,ce+O,O*1.5,O*3,0,0,Math.PI*2),e.fill(),e.fillStyle=`rgba(0, 255, 255, ${.7*k})`,e.beginPath(),e.moveTo(V-O*.6,f),e.lineTo(V+O*.6,f),e.lineTo(V,f+O*3),e.closePath(),e.fill()}function Oe(){m.doubleBlaster.active?(fe(i.x+i.width*.25,i.y),fe(i.x+i.width*.75,i.y)):fe(i.x+i.width/2,i.y)}const b=[];function Ee(e,t,n,s="#ffffff"){N||b.push({text:e,x:t,y:n,opacity:1,color:s})}function ut(){if(!N)for(let e=b.length-1;e>=0;e--)b[e].y-=.5,b[e].opacity-=.02,b[e].opacity<=0&&b.splice(e,1)}function ct(e){N||b.forEach(t=>{e.globalAlpha=t.opacity,e.fillStyle=t.color,e.font="16px Inter",e.fillText(t.text,t.x,t.y),e.globalAlpha=1})}let Me=Ce,dt=1;const R={};let ft=ke,_e=0;function ht(){_e=0}function mt(e,t){const n=[],s=Math.PI*2/t;for(let o=0;o<t;o++){const r=o*s,l=e*(.8+Math.random()*.4);n.push({x:l*Math.cos(r),y:l*Math.sin(r)})}return n}function xe(e,t,n,s=0,o=0,r=null){const l=B[n],c=Ne[n],u=Math.floor(Math.random()*6)+5,a=N?Math.min(u,5):u,h=mt(l,a),f=dt++;r===null&&(R[f]=0);const g=r??f;typeof R[g]>"u"&&(R[g]=0),n===B.length-1&&R[g]++;const A=Math.random()*(ft-Me)+Me,F=r===null?A:A*.3,C=Math.random()*2*Math.PI,x=Math.random()*.01-.05,k=Date.now();p.push({x:e,y:t,radius:l,speed:F,dx:s,dy:o,shape:h,level:n,scoreValue:c,id:f,parentId:g,rotation:C,rotationSpeed:x,creationTime:k}),n===0&&_e++}function vt(e,t,n,s,o=!0){const r=Date.now(),l=100,c=3e4;for(let u=0;u<p.length;u++){const a=p[u];a.creationTime||(a.creationTime=r),a.y+=a.speed+a.dy,a.x+=a.dx,a.rotation=(a.rotation+a.rotationSpeed)%(2*Math.PI);const h=a.y>t+l||a.x+a.radius*2<-100||a.x>e+l,f=r-a.creationTime>c;(h||f)&&(p.splice(u,1),u--)}o&&r-s.value>n&&(xe(Math.random()*(e-B[0]*2),-B[0]*2,0),s.value=r)}function pt(e){e.strokeStyle="#ff4500",e.lineWidth=2,p.forEach(t=>{e.save(),e.translate(t.x+t.radius,t.y+t.radius),e.rotate(t.rotation),e.beginPath(),e.moveTo(t.shape[0].x,t.shape[0].y);for(let n=1;n<t.shape.length;n++)e.lineTo(t.shape[n].x,t.shape[n].y);e.closePath(),e.stroke(),e.restore()})}function gt(e,t){const n=p.indexOf(e);if(n!==-1){if(p.splice(n,1),Z("break"),e.level<B.length-1){const s=e.level+1,o=Math.floor(Math.random()*2)+2;for(let r=0;r<o;r++){const l=Math.random()*Math.PI*2,c=Math.random()<.8?Math.random()*.7+.3:Math.random()*1.5+1,u=Math.cos(l)*c,a=Math.sin(l)*c;xe(e.x+e.radius,e.y+e.radius,s,u,a,e.parentId??e.id)}}t.value+=e.scoreValue,Ee(`+${e.scoreValue}`,e.x+e.radius,e.y),e.parentId!==null&&e.level===B.length-1&&(R[e.parentId]--,R[e.parentId]===0&&(t.value+=150,Ee("+150 (All Fragments)",e.x,e.y-10,"#00ff00"),delete R[e.parentId]))}}const ae={DOUBLE_BLASTER:"doubleBlaster",SHIELD:"shield"},X=50,G=[];function Et(e){const t=Math.random()*(e-X),n=-50,s=Math.random()<.5?ae.DOUBLE_BLASTER:ae.SHIELD;G.push({x:t,y:n,size:X,type:s,dy:1.5})}function yt(e){for(let t=G.length-1;t>=0;t--){const n=G[t];if(n.y+=n.dy,n.y>e){G.splice(t,1);continue}i.x<n.x+n.size&&i.x+i.width>n.x&&i.y<n.y+n.size&&i.y+i.height>n.y&&(wt(n.type),G.splice(t,1),Ee(`Power-up! ${n.type}`,i.x,i.y-20,"#00ffff"))}Object.keys(m).forEach(t=>{m[t].active&&(m[t].timer--,m[t].timer<=0&&(m[t].active=!1))})}function Lt(e){G.forEach(t=>{const n=t.x+X/2,s=t.y+X/2,o=X/2,r=performance.now()/600,l=(Math.sin(r)+1)/2,c=.75+.5*l;if(e.save(),e.translate(n,s),e.scale(c,c),e.translate(-n,-s),t.type===ae.DOUBLE_BLASTER){const a=o*.8,h=a/2.5;e.shadowColor="#f9d71c",e.shadowBlur=15*l,e.fillStyle="#f9d71c",e.beginPath();for(let f=0;f<5;f++){const g=Math.PI/2*3+f*Math.PI*2/5,A=n+Math.cos(g)*a,F=s+Math.sin(g)*a;e.lineTo(A,F);const C=g+Math.PI/5,x=n+Math.cos(C)*h,k=s+Math.sin(C)*h;e.lineTo(x,k)}e.closePath(),e.fill()}else if(t.type===ae.SHIELD){const u=o*(.75+.25*l),a=e.createRadialGradient(n,s,u*.1,n,s,u);a.addColorStop(0,`rgba(0, 255, 255, ${.8*l})`),a.addColorStop(1,"rgba(0, 255, 255, 0)"),e.fillStyle=a,e.beginPath(),e.arc(n,s,u,0,Math.PI*2),e.fill(),e.fillStyle="#0ff",e.beginPath(),e.arc(n,s,u*.6,0,Math.PI*2),e.fill()}e.restore()})}function wt(e){m[e].active=!0,m[e].timer=600}function Pt(e,t,n,s,o,r,l){const c=Math.max(s,Math.min(e,s+r)),u=Math.max(o,Math.min(t,o+l)),a=e-c,h=t-u;return a*a+h*h<n*n}function _t(){const e=i.x,t=i.y,n=i.width,s=i.height;for(const o of p){const r=o.x+o.radius,l=o.y+o.radius;if(Pt(r,l,o.radius,e,t,n,s))return o}return null}function At(){for(let e=E.length-1;e>=0;e--){const t=E[e];for(let n=p.length-1;n>=0;n--){const s=p[n],o=t.x-(s.x+s.radius),r=t.y-(s.y+s.radius);if(Math.sqrt(o*o+r*r)<t.radius+s.radius){E.splice(e,1),gt(s,T);break}}}}function St(){_t()&&(m.shield.active||v(()=>Promise.resolve().then(()=>Ft),void 0).then(t=>t.handlePlayerHit())),At()}let z=!1,q=null;const It=5e3,Tt=20;function J(){U.value=!0,z=!1,q=null,re.value=Date.now(),console.log("[FlowManager] Level flow reset")}function Ot(e){const t=Date.now();if((t-re.value)/1e3,_e>=(P.value+1)*Tt&&(U.value=!1),!U.value&&!z&&p.length===0&&(z=!0,q=t),z&&q){const n=t-q,s=t-re.value;(n>=1500||s>=It)&&(P.value++,d.value="LEVEL_TRANSITION",E.length=0,U.value=!0,z=!1,q=null,v(()=>Promise.resolve().then(()=>w),void 0).then(o=>o.playSound("levelup")),v(()=>Promise.resolve().then(()=>w),void 0).then(o=>o.stopMusic()),e())}}function Mt(e){e.fillStyle="#ffffff",e.font='24px "Inter", sans-serif',e.textAlign="left",e.fillText(`Score: ${T.value}`,20,40),e.fillText(`Level: ${P.value+1}`,20,70),e.fillText(`Lives: ${I.value}`,20,100)}function bt(e){let s=120;e.font="18px monospace",e.fillStyle="#00ffff",Object.entries(m).forEach(([o,r])=>{if(r.active){const l=Math.ceil(r.timer/60);e.fillText(`${Rt(o)}: ${l}s`,20,s),s+=24}})}function Rt(e){return e.charAt(0).toUpperCase()+e.slice(1)}function Bt(e){d.value==="PLAYING"&&(at(e),pt(e),rt(e),Lt(e),Mt(e),ct(e),bt(e))}const Dt=60,Nt=1e3/Dt;let be=0,Y,ye,he=0;const Ct=1e4,We=300;function kt(e){const t=Ve-e*Ge;return Math.max(t,We)}let Re=We;function Vt(e){Y=e,Y.width=window.innerWidth,Y.height=window.innerHeight,ye=Y.getContext("2d")}function S(){Y&&requestAnimationFrame(e=>oe(Y,e))}function oe(e,t=0){if(t-be<Nt){requestAnimationFrame(n=>oe(e,n));return}if(be=t,d.value!=="PLAYING"){requestAnimationFrame(n=>oe(e,n));return}ye.clearRect(0,0,e.width,e.height),Re=kt(P.value),(!he||t-he>Ct)&&(Et(e.width),he=t),lt(),vt(e.width,e.height,Re,De,U.value),st(e.height),yt(e.height),ut(),St(),Bt(ye),Ot(()=>{ht(),J(),v(()=>Promise.resolve().then(()=>Ue),void 0).then(n=>{n.showOverlay("LEVEL_TRANSITION",T.value,P.value)})}),requestAnimationFrame(n=>oe(e,n))}function Gt(){const e=document.createElement("div");e.style.position="absolute",e.style.top="20px",e.style.right="20px",e.style.zIndex="20",e.style.display="flex",e.style.gap="10px";const t=document.createElement("button");t.textContent="ðŸ”‡",t.addEventListener("touchstart",o=>{o.preventDefault(),K()},{passive:!1}),t.addEventListener("click",()=>K());const n=document.createElement("button");n.textContent="ðŸ”Š",n.addEventListener("touchstart",o=>{o.preventDefault(),$()},{passive:!1}),n.addEventListener("click",()=>$());const s=document.createElement("input");s.type="range",s.min="0",s.max="1",s.step="0.05",s.value=D.toString(),s.oninput=o=>{const r=parseFloat(o.target.value);$e(r)},e.appendChild(t),e.appendChild(n),e.appendChild(s),document.body.appendChild(e)}function Yt(){I.value-=1,Z("gameover"),I.value<=0?(d.value="GAME_OVER",ue(),_("GAME_OVER",T.value,P.value)):(d.value="LEVEL_TRANSITION",Ut(),_("LEVEL_TRANSITION",T.value,P.value))}function Ut(){i.x=window.innerWidth/2-i.width/2,i.y=window.innerHeight-i.height-50,i.dx=0,i.dy=0,E.length=0,p.length=0,J(),ue()}function H(e){d.value="PLAYING",T.value=0,P.value=0,I.value=3,m.shield.active=!1,m.shield.timer=0,m.doubleBlaster.active=!1,m.doubleBlaster.timer=0,E.length=0,p.length=0,i.x=e.width/2-i.width/2,i.y=e.height-i.height-50,i.dx=0,i.dy=0,J(),_("PLAYING"),Gt(),$(),v(()=>Promise.resolve().then(()=>w),void 0).then(n=>n.startMusic()),e.getContext("2d").clearRect(0,0,e.width,e.height)}function Le(){d.value="PLAYING",J(),_("PLAYING"),Fe()}function $t(){d.value="GAME_OVER",ue(),Z("gameover"),_("GAME_OVER",T.value,P.value)}const Ft=Object.freeze(Object.defineProperty({__proto__:null,continueGame:Le,endGame:$t,handlePlayerHit:Yt,resetLevelFlow:J,showOverlay:_,startGame:H},Symbol.toStringTag,{value:"Module"}));let ie=!1,se=null,M=!1,Q=0;const Be=150;function xt(e){document.addEventListener("keydown",t=>{if(t.key==="p"&&!M){if(M=!0,d.value!=="PLAYING"&&d.value!=="PAUSED"){M=!1;return}const n=d.value==="PLAYING"?"PAUSED":"PLAYING";d.value=n,_(n),n==="PAUSED"?(K(),me()):n==="PLAYING"&&($(),S()),setTimeout(()=>M=!1,300);return}if(d.value==="PLAYING")switch(t.key){case"ArrowUp":case"w":i.dy=-i.speed;break;case"ArrowDown":case"s":i.dy=i.speed;break;case"ArrowLeft":case"a":i.dx=-i.speed;break;case"ArrowRight":case"d":i.dx=i.speed;break;case" ":const n=Date.now();n-Q>Be&&(Oe(),Q=n);break}}),document.addEventListener("keyup",t=>{if(d.value==="PLAYING")switch(t.key){case"ArrowUp":case"w":case"ArrowDown":case"s":i.dy=0;break;case"ArrowLeft":case"a":case"ArrowRight":case"d":i.dx=0;break}}),e.addEventListener("mousemove",t=>{if(d.value!=="PLAYING")return;const n=e.getBoundingClientRect(),s=t.clientX-n.left,o=t.clientY-n.top;i.x=s-i.width/2,i.y=o-i.height/2}),e.addEventListener("mousedown",t=>{if(d.value!=="PLAYING"||t.button!==0||ie)return;ie=!0;function n(){if(!ie||d.value!=="PLAYING")return;const s=Date.now();s-Q>Be&&(Oe(),Q=s),se=setTimeout(n,100)}n()}),e.addEventListener("mouseup",t=>{t.button===0&&me()}),e.addEventListener("contextmenu",t=>{if(t.preventDefault(),!M&&(d.value==="PLAYING"||d.value==="PAUSED")){M=!0;const n=d.value==="PLAYING"?"PAUSED":"PLAYING";d.value=n,_(n),n==="PAUSED"?(K(),me()):n==="PLAYING"&&($(),S()),setTimeout(()=>M=!1,300)}})}function me(){ie=!1,se&&(clearTimeout(se),se=null)}function Wt(){const e=document.getElementById("gameCanvas"),t=document.getElementById("startButton"),n=document.getElementById("restartButton"),s=document.getElementById("continueButton"),o=document.getElementById("quitButton"),r=document.getElementById("starfieldCanvas");!N&&r&&it(r),ve(e),ge(e),Vt(e),xt(e),window.addEventListener("resize",()=>{ve(e),ge(e)});let l=!1;t.addEventListener("touchstart",c=>{c.preventDefault(),!(d.value!=="START"||l)&&(l=!0,v(()=>Promise.resolve().then(()=>w),void 0).then(u=>u.unlockAudio()),H(e),S(),setTimeout(()=>l=!1,1e3))},{passive:!1}),t.addEventListener("click",()=>{d.value!=="START"||l||(l=!0,v(()=>Promise.resolve().then(()=>w),void 0).then(c=>c.unlockAudio()),H(e),S(),setTimeout(()=>l=!1,1e3))}),n.addEventListener("touchstart",c=>{c.preventDefault(),H(e),S()},{passive:!1}),n.addEventListener("click",()=>{H(e),S()}),s.addEventListener("touchstart",c=>{c.preventDefault(),Le(),S()},{passive:!1}),s.addEventListener("click",()=>{Le(),S()}),o&&(o.addEventListener("touchstart",c=>{c.preventDefault(),pe()},{passive:!1}),o.addEventListener("click",()=>pe())),_("START")}window.addEventListener("DOMContentLoaded",Wt);
